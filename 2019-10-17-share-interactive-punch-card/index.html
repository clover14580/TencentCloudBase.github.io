<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>互动打卡 | 云开发-一站式后端云服务</title>
    <meta name="generator" content="VuePress 1.4.1">
    <script type="text/javascript" src="/scripts/redirect.js" async=""></script>
    <script type="text/javascript" src="/scripts/baidu-analytics.js" async=""></script>
    <script type="text/javascript" src="https://v1.cnzz.com/z_stat.php?id=1278701707&amp;web_id=1278701707" async=""></script>
    <script type="text/javascript" src="/scripts/mta-analytics.js" async=""></script>
    <link rel="icon" href="/favicon.png">
    <meta name="description" content="云+端一体化：快速构建小程序、Web和移动应用">
    <link rel="preload" href="/assets/css/0.styles.c9918053.css" as="style"><link rel="preload" href="/assets/js/app.d354b57d.js" as="script"><link rel="preload" href="/assets/js/2.633ad409.js" as="script"><link rel="preload" href="/assets/js/3.c53e7137.js" as="script"><link rel="preload" href="/assets/js/188.2accadf2.js" as="script"><link rel="preload" href="/assets/js/5.fbbd7676.js" as="script"><link rel="prefetch" href="/assets/js/10.7835a66c.js"><link rel="prefetch" href="/assets/js/100.c25c8c34.js"><link rel="prefetch" href="/assets/js/101.8f7915bb.js"><link rel="prefetch" href="/assets/js/102.a8f273d4.js"><link rel="prefetch" href="/assets/js/103.324cc2de.js"><link rel="prefetch" href="/assets/js/104.8a073b13.js"><link rel="prefetch" href="/assets/js/105.72ca4dce.js"><link rel="prefetch" href="/assets/js/106.457d1d57.js"><link rel="prefetch" href="/assets/js/107.c66421a8.js"><link rel="prefetch" href="/assets/js/108.cf4c67c3.js"><link rel="prefetch" href="/assets/js/109.4f1a9aa4.js"><link rel="prefetch" href="/assets/js/11.26a5775e.js"><link rel="prefetch" href="/assets/js/110.676bd8e6.js"><link rel="prefetch" href="/assets/js/111.5ab0231d.js"><link rel="prefetch" href="/assets/js/112.80e02474.js"><link rel="prefetch" href="/assets/js/113.b1df0a58.js"><link rel="prefetch" href="/assets/js/114.2206a321.js"><link rel="prefetch" href="/assets/js/115.880dbc82.js"><link rel="prefetch" href="/assets/js/116.09d16701.js"><link rel="prefetch" href="/assets/js/117.fce822ab.js"><link rel="prefetch" href="/assets/js/118.e5bb95b1.js"><link rel="prefetch" href="/assets/js/119.dd260974.js"><link rel="prefetch" href="/assets/js/12.e7d9cd53.js"><link rel="prefetch" href="/assets/js/120.6b905814.js"><link rel="prefetch" href="/assets/js/121.1450c04f.js"><link rel="prefetch" href="/assets/js/122.47404103.js"><link rel="prefetch" href="/assets/js/123.c3bdf3d0.js"><link rel="prefetch" href="/assets/js/124.a42e1284.js"><link rel="prefetch" href="/assets/js/125.cc4f1a01.js"><link rel="prefetch" href="/assets/js/126.7140e48b.js"><link rel="prefetch" href="/assets/js/127.94fee69f.js"><link rel="prefetch" href="/assets/js/128.bf63660e.js"><link rel="prefetch" href="/assets/js/129.b162f141.js"><link rel="prefetch" href="/assets/js/13.a9e1e099.js"><link rel="prefetch" href="/assets/js/130.f0543b4d.js"><link rel="prefetch" href="/assets/js/131.adc91cdc.js"><link rel="prefetch" href="/assets/js/132.11644c20.js"><link rel="prefetch" href="/assets/js/133.21eb4899.js"><link rel="prefetch" href="/assets/js/134.041dfed6.js"><link rel="prefetch" href="/assets/js/135.be2cab87.js"><link rel="prefetch" href="/assets/js/136.603372b0.js"><link rel="prefetch" href="/assets/js/137.d215b3aa.js"><link rel="prefetch" href="/assets/js/138.223cd26e.js"><link rel="prefetch" href="/assets/js/139.3d1a61d2.js"><link rel="prefetch" href="/assets/js/14.00819d3d.js"><link rel="prefetch" href="/assets/js/140.b2c292c6.js"><link rel="prefetch" href="/assets/js/141.9c9c28e5.js"><link rel="prefetch" href="/assets/js/142.aa24da5f.js"><link rel="prefetch" href="/assets/js/143.aa7ab106.js"><link rel="prefetch" href="/assets/js/144.59d2f7a7.js"><link rel="prefetch" href="/assets/js/145.00bc3c89.js"><link rel="prefetch" href="/assets/js/146.870e043f.js"><link rel="prefetch" href="/assets/js/147.bba2ae71.js"><link rel="prefetch" href="/assets/js/148.96cb8daa.js"><link rel="prefetch" href="/assets/js/149.f7075132.js"><link rel="prefetch" href="/assets/js/15.6dccd018.js"><link rel="prefetch" href="/assets/js/150.a84fd4f8.js"><link rel="prefetch" href="/assets/js/151.50818b4a.js"><link rel="prefetch" href="/assets/js/152.ea873b64.js"><link rel="prefetch" href="/assets/js/153.a874580c.js"><link rel="prefetch" href="/assets/js/154.c2d1c90a.js"><link rel="prefetch" href="/assets/js/155.e3b2aaca.js"><link rel="prefetch" href="/assets/js/156.46722f7a.js"><link rel="prefetch" href="/assets/js/157.1dee356b.js"><link rel="prefetch" href="/assets/js/158.0d60d19a.js"><link rel="prefetch" href="/assets/js/159.52f63f30.js"><link rel="prefetch" href="/assets/js/16.593db609.js"><link rel="prefetch" href="/assets/js/160.075fddb5.js"><link rel="prefetch" href="/assets/js/161.2f602001.js"><link rel="prefetch" href="/assets/js/162.d15dc70a.js"><link rel="prefetch" href="/assets/js/163.3e1a23ea.js"><link rel="prefetch" href="/assets/js/164.1c5bc3f4.js"><link rel="prefetch" href="/assets/js/165.b431792e.js"><link rel="prefetch" href="/assets/js/166.5d58f178.js"><link rel="prefetch" href="/assets/js/167.01de76bc.js"><link rel="prefetch" href="/assets/js/168.ff7cc2a1.js"><link rel="prefetch" href="/assets/js/169.b667e25d.js"><link rel="prefetch" href="/assets/js/17.22d99d1f.js"><link rel="prefetch" href="/assets/js/170.3918d613.js"><link rel="prefetch" href="/assets/js/171.b8856e59.js"><link rel="prefetch" href="/assets/js/172.06cff577.js"><link rel="prefetch" href="/assets/js/173.a5990a8b.js"><link rel="prefetch" href="/assets/js/174.4715c481.js"><link rel="prefetch" href="/assets/js/175.5fb77435.js"><link rel="prefetch" href="/assets/js/176.c61a3f40.js"><link rel="prefetch" href="/assets/js/177.b2e5b363.js"><link rel="prefetch" href="/assets/js/178.c924522e.js"><link rel="prefetch" href="/assets/js/179.147ac77c.js"><link rel="prefetch" href="/assets/js/18.a6834717.js"><link rel="prefetch" href="/assets/js/180.1a6adc64.js"><link rel="prefetch" href="/assets/js/181.62e246cb.js"><link rel="prefetch" href="/assets/js/182.92564a35.js"><link rel="prefetch" href="/assets/js/183.c23dfa2c.js"><link rel="prefetch" href="/assets/js/184.77017f2f.js"><link rel="prefetch" href="/assets/js/185.85dff076.js"><link rel="prefetch" href="/assets/js/186.35bcae4b.js"><link rel="prefetch" href="/assets/js/187.cf7f539b.js"><link rel="prefetch" href="/assets/js/189.0a944970.js"><link rel="prefetch" href="/assets/js/19.dced53ee.js"><link rel="prefetch" href="/assets/js/190.51f24fd3.js"><link rel="prefetch" href="/assets/js/191.89964f32.js"><link rel="prefetch" href="/assets/js/192.6283545d.js"><link rel="prefetch" href="/assets/js/193.c4c82e72.js"><link rel="prefetch" href="/assets/js/194.29038c9b.js"><link rel="prefetch" href="/assets/js/195.8586ec6d.js"><link rel="prefetch" href="/assets/js/196.d75797e1.js"><link rel="prefetch" href="/assets/js/197.14587c1b.js"><link rel="prefetch" href="/assets/js/198.9160c552.js"><link rel="prefetch" href="/assets/js/199.6457eb34.js"><link rel="prefetch" href="/assets/js/20.67a23c24.js"><link rel="prefetch" href="/assets/js/200.c42d4e04.js"><link rel="prefetch" href="/assets/js/201.82b59132.js"><link rel="prefetch" href="/assets/js/202.df6a631d.js"><link rel="prefetch" href="/assets/js/203.04ddcc2c.js"><link rel="prefetch" href="/assets/js/204.47162888.js"><link rel="prefetch" href="/assets/js/205.fb91cb3b.js"><link rel="prefetch" href="/assets/js/206.6d4c993a.js"><link rel="prefetch" href="/assets/js/207.ad7a23d6.js"><link rel="prefetch" href="/assets/js/208.f3a2aa30.js"><link rel="prefetch" href="/assets/js/209.225ce8c0.js"><link rel="prefetch" href="/assets/js/21.b762c8ca.js"><link rel="prefetch" href="/assets/js/210.b2c90df1.js"><link rel="prefetch" href="/assets/js/211.fd2936c5.js"><link rel="prefetch" href="/assets/js/212.fc1418cd.js"><link rel="prefetch" href="/assets/js/213.44ebc89b.js"><link rel="prefetch" href="/assets/js/214.09e10719.js"><link rel="prefetch" href="/assets/js/215.f202d12b.js"><link rel="prefetch" href="/assets/js/216.55848856.js"><link rel="prefetch" href="/assets/js/217.cc6a38e8.js"><link rel="prefetch" href="/assets/js/218.15c77201.js"><link rel="prefetch" href="/assets/js/219.312d78e5.js"><link rel="prefetch" href="/assets/js/22.edc2e3b7.js"><link rel="prefetch" href="/assets/js/220.0d6b55ac.js"><link rel="prefetch" href="/assets/js/221.0a5b84e5.js"><link rel="prefetch" href="/assets/js/222.84f631bd.js"><link rel="prefetch" href="/assets/js/223.407eb3e8.js"><link rel="prefetch" href="/assets/js/224.27169763.js"><link rel="prefetch" href="/assets/js/225.ab9d71f3.js"><link rel="prefetch" href="/assets/js/226.4df23489.js"><link rel="prefetch" href="/assets/js/227.3a1b1442.js"><link rel="prefetch" href="/assets/js/228.b703667e.js"><link rel="prefetch" href="/assets/js/229.6678328a.js"><link rel="prefetch" href="/assets/js/23.f55d76a9.js"><link rel="prefetch" href="/assets/js/230.4ac01687.js"><link rel="prefetch" href="/assets/js/231.334cb74a.js"><link rel="prefetch" href="/assets/js/232.c75d6546.js"><link rel="prefetch" href="/assets/js/233.5636030f.js"><link rel="prefetch" href="/assets/js/234.63d3dcc1.js"><link rel="prefetch" href="/assets/js/235.a5099ec5.js"><link rel="prefetch" href="/assets/js/24.fb2ce093.js"><link rel="prefetch" href="/assets/js/25.1308efe0.js"><link rel="prefetch" href="/assets/js/26.46c35484.js"><link rel="prefetch" href="/assets/js/27.2fa23e2f.js"><link rel="prefetch" href="/assets/js/28.2c3e2691.js"><link rel="prefetch" href="/assets/js/29.72850142.js"><link rel="prefetch" href="/assets/js/30.a3711c43.js"><link rel="prefetch" href="/assets/js/31.72f075c0.js"><link rel="prefetch" href="/assets/js/32.492fb8b7.js"><link rel="prefetch" href="/assets/js/33.e5160512.js"><link rel="prefetch" href="/assets/js/34.97b40320.js"><link rel="prefetch" href="/assets/js/35.bcc0fc81.js"><link rel="prefetch" href="/assets/js/36.6abe06dd.js"><link rel="prefetch" href="/assets/js/37.ae44b05e.js"><link rel="prefetch" href="/assets/js/38.e963088a.js"><link rel="prefetch" href="/assets/js/39.d4dba94f.js"><link rel="prefetch" href="/assets/js/4.1f58cf85.js"><link rel="prefetch" href="/assets/js/40.1ff42f42.js"><link rel="prefetch" href="/assets/js/41.8edd6b16.js"><link rel="prefetch" href="/assets/js/42.f56c90c2.js"><link rel="prefetch" href="/assets/js/43.9e7cf8bf.js"><link rel="prefetch" href="/assets/js/44.fc5bab21.js"><link rel="prefetch" href="/assets/js/45.34ee6430.js"><link rel="prefetch" href="/assets/js/46.be509df6.js"><link rel="prefetch" href="/assets/js/47.dfb5b86c.js"><link rel="prefetch" href="/assets/js/48.a3d7ddf1.js"><link rel="prefetch" href="/assets/js/49.31ea3c0b.js"><link rel="prefetch" href="/assets/js/50.7b923139.js"><link rel="prefetch" href="/assets/js/51.876075bb.js"><link rel="prefetch" href="/assets/js/52.83a1ff06.js"><link rel="prefetch" href="/assets/js/53.c97e1e82.js"><link rel="prefetch" href="/assets/js/54.f817ff4a.js"><link rel="prefetch" href="/assets/js/55.9a82226b.js"><link rel="prefetch" href="/assets/js/56.df6266aa.js"><link rel="prefetch" href="/assets/js/57.6eea1419.js"><link rel="prefetch" href="/assets/js/58.4597b19f.js"><link rel="prefetch" href="/assets/js/59.527c4b49.js"><link rel="prefetch" href="/assets/js/6.db496812.js"><link rel="prefetch" href="/assets/js/60.b83a5818.js"><link rel="prefetch" href="/assets/js/61.828c8ff0.js"><link rel="prefetch" href="/assets/js/62.1844a6b3.js"><link rel="prefetch" href="/assets/js/63.4a1897e6.js"><link rel="prefetch" href="/assets/js/64.e2f1bb9e.js"><link rel="prefetch" href="/assets/js/65.fbc981ed.js"><link rel="prefetch" href="/assets/js/66.a79d661a.js"><link rel="prefetch" href="/assets/js/67.a7abd390.js"><link rel="prefetch" href="/assets/js/68.54050464.js"><link rel="prefetch" href="/assets/js/69.4c0c3a3e.js"><link rel="prefetch" href="/assets/js/7.30efd180.js"><link rel="prefetch" href="/assets/js/70.90ee7afc.js"><link rel="prefetch" href="/assets/js/71.a881c3a5.js"><link rel="prefetch" href="/assets/js/72.f97a8baa.js"><link rel="prefetch" href="/assets/js/73.727b2106.js"><link rel="prefetch" href="/assets/js/74.f749e7bb.js"><link rel="prefetch" href="/assets/js/75.69cae158.js"><link rel="prefetch" href="/assets/js/76.1126d572.js"><link rel="prefetch" href="/assets/js/77.be41246a.js"><link rel="prefetch" href="/assets/js/78.38188e4d.js"><link rel="prefetch" href="/assets/js/79.1666db29.js"><link rel="prefetch" href="/assets/js/8.fee51c2e.js"><link rel="prefetch" href="/assets/js/80.6cd67bf2.js"><link rel="prefetch" href="/assets/js/81.3be4f3ad.js"><link rel="prefetch" href="/assets/js/82.884215d9.js"><link rel="prefetch" href="/assets/js/83.0192e9a8.js"><link rel="prefetch" href="/assets/js/84.8969c4c6.js"><link rel="prefetch" href="/assets/js/85.3d019898.js"><link rel="prefetch" href="/assets/js/86.f7d19979.js"><link rel="prefetch" href="/assets/js/87.55b22713.js"><link rel="prefetch" href="/assets/js/88.9f711ca3.js"><link rel="prefetch" href="/assets/js/89.e2039a3a.js"><link rel="prefetch" href="/assets/js/9.8a9e20ca.js"><link rel="prefetch" href="/assets/js/90.88cbea83.js"><link rel="prefetch" href="/assets/js/91.d6d77cbc.js"><link rel="prefetch" href="/assets/js/92.c2a61065.js"><link rel="prefetch" href="/assets/js/93.19bcd04e.js"><link rel="prefetch" href="/assets/js/94.68bf65e3.js"><link rel="prefetch" href="/assets/js/95.27a50a43.js"><link rel="prefetch" href="/assets/js/96.8a0f0fcd.js"><link rel="prefetch" href="/assets/js/97.d58e3f8f.js"><link rel="prefetch" href="/assets/js/98.7b5a66c9.js"><link rel="prefetch" href="/assets/js/99.115a36f0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c9918053.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><a href="https://www.cloudbase.net" target="_blank" class="home-link"><img src="/favicon.png" alt="云开发-一站式后端云服务" class="logo"> <span class="site-name can-hide">云开发</span></a> <div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <div class="links"><nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="活动" class="dropdown-title"><span class="title">活动</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/2020-03-23-zero-training-camp/" class="nav-link">
  云开发零基础训练营
</a></li><li class="dropdown-item"><!----> <a href="/2020-03-23-diy-camp/" class="nav-link">
  云开发实战营
</a></li><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/ENA2TAJ2fHtyMgFQ5kbBAA" target="_blank" rel="noopener noreferrer" class="nav-link external">
  云开发校园工作坊
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习" class="dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/2019-09-03-share-miniprogram-cloud-basic-concept/" class="nav-link">
  视频教程
</a></li><li class="dropdown-item"><!----> <a href="/2019-09-03-share-tree-hole/" class="nav-link">
  官方案例
</a></li><li class="dropdown-item"><!----> <a href="/2019-09-03-share-maoyan/" class="nav-link">
  项目实战
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/TencentCloudBase/blog/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  案例提交
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生态" class="dropdown-title"><span class="title">生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          开源生态
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/2019-10-28-opensource-guidelines/" class="nav-link">
  开源协同
</a></li></ul></li><li class="dropdown-item"><h4>
          高校生态
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/2020-03-19-edu-support/" class="nav-link">
  教学支持
</a></li><li class="dropdown-subitem"><a href="https://mp.weixin.qq.com/s/HIwsvl4lplns8m4KQJ9Ayg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  校园布道师
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          第三方服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/2020-03-24-third-docs/" class="nav-link">
  第三方服务文档规范
</a></li></ul></li><li class="dropdown-item"><h4>
          云开发布道师
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/2020-03-23-preacher/" class="nav-link">
  云开发布道师权益
</a></li><li class="dropdown-subitem"><a href="https://wj.qq.com/s2/5715673/0bcf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  云开发布道师申请
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/product/" class="nav-link">
  产品公告
</a></div><div class="nav-item"><a href="/2020-03-24-q-and-a/" class="nav-link">
  Q &amp; A
</a></div> <a href="https://github.com/TencentCloudBase/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div> <div class="links" style="position:absolute;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links"><div class="nav-item"><a href="https://console.cloud.tencent.com/tcb?from=12304" target="_blank" class="nav-link">
          去控制台
        </a></div></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="活动" class="dropdown-title"><span class="title">活动</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/2020-03-23-zero-training-camp/" class="nav-link">
  云开发零基础训练营
</a></li><li class="dropdown-item"><!----> <a href="/2020-03-23-diy-camp/" class="nav-link">
  云开发实战营
</a></li><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/ENA2TAJ2fHtyMgFQ5kbBAA" target="_blank" rel="noopener noreferrer" class="nav-link external">
  云开发校园工作坊
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习" class="dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/2019-09-03-share-miniprogram-cloud-basic-concept/" class="nav-link">
  视频教程
</a></li><li class="dropdown-item"><!----> <a href="/2019-09-03-share-tree-hole/" class="nav-link">
  官方案例
</a></li><li class="dropdown-item"><!----> <a href="/2019-09-03-share-maoyan/" class="nav-link">
  项目实战
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/TencentCloudBase/blog/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  案例提交
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生态" class="dropdown-title"><span class="title">生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          开源生态
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/2019-10-28-opensource-guidelines/" class="nav-link">
  开源协同
</a></li></ul></li><li class="dropdown-item"><h4>
          高校生态
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/2020-03-19-edu-support/" class="nav-link">
  教学支持
</a></li><li class="dropdown-subitem"><a href="https://mp.weixin.qq.com/s/HIwsvl4lplns8m4KQJ9Ayg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  校园布道师
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          第三方服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/2020-03-24-third-docs/" class="nav-link">
  第三方服务文档规范
</a></li></ul></li><li class="dropdown-item"><h4>
          云开发布道师
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/2020-03-23-preacher/" class="nav-link">
  云开发布道师权益
</a></li><li class="dropdown-subitem"><a href="https://wj.qq.com/s2/5715673/0bcf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  云开发布道师申请
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/product/" class="nav-link">
  产品公告
</a></div><div class="nav-item"><a href="/2020-03-24-q-and-a/" class="nav-link">
  Q &amp; A
</a></div> <a href="https://github.com/TencentCloudBase/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>视频教程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础教程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-miniprogram-cloud-basic-concept/" class="sidebar-link">小程序-云开发-概念基础</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-operation/" class="sidebar-link">小程序-云开发-操作基础</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-api/" class="sidebar-link">小程序-云开发-云开发API基础</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>中级课程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-miniprogram-cloud-middle-scf/" class="sidebar-link">小程序-云开发-云函数项目实战</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-middle-db/" class="sidebar-link">小程序-云开发-数据库项目实战</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-middle-cos/" class="sidebar-link">小程序-云开发-文件存储项目实战</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>高阶实战</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-miniprogram-cloud-advanced-wechat-pay/" class="sidebar-link">巧借 [ 小程序云开发 ] 快速接入微信支付功能</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-advanced-bookcase/" class="sidebar-link">小程序-云开发-私房书柜项目实战</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-advanced-music-player/" class="sidebar-link">从0到1实现音乐播放器小程序</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>小程序-云开发基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-miniprogram-cloud-basic-learn/" class="sidebar-link">了解云开发基础</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-db/" class="sidebar-link">云开发数据库能力介绍</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-db-permission/" class="sidebar-link">云开发数据库权限介绍</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-cos-storage/" class="sidebar-link">云开发文件存储能力介绍</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-scf-timer/" class="sidebar-link">云函数基础用法之定时器</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-practice-todo/" class="sidebar-link">云开发实战之 TODO</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-scf-db/" class="sidebar-link">云函数应用之数据库操作</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-scf-features/" class="sidebar-link">云函数应用之功能操作</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>小游戏-云开发实战</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-minigame-cloud-introduction/" class="sidebar-link">云开发介绍</a></li><li><a href="/2019-09-03-share-minigame-cloud-basic/" class="sidebar-link">游戏云开发基础</a></li><li><a href="/2019-09-03-share-minigame-cloud-login-register/" class="sidebar-link">用户登录注册</a></li><li><a href="/2019-09-03-share-minigame-cloud-share/" class="sidebar-link">小游戏分享</a></li><li><a href="/2019-09-03-share-minigame-cloud-practice/" class="sidebar-link">小游戏实现</a></li><li><a href="/2019-09-03-share-minigame-cloud-ad/" class="sidebar-link">广告接入</a></li><li><a href="/2019-09-03-share-minigame-cloud-pay/" class="sidebar-link">云开发支付</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>电商小程序-云开发初探</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-e-commerce-introduction/" class="sidebar-link">课程介绍</a></li><li><a href="/2019-09-03-share-e-commerce-personal/" class="sidebar-link">个人中心</a></li><li><a href="/2019-09-03-share-e-commerce-preview/" class="sidebar-link">电商小程序雏形</a></li><li><a href="/2019-09-03-share-e-commerce-features-first/" class="sidebar-link">电商通用功能-上</a></li><li><a href="/2019-09-03-share-e-commerce-features-second/" class="sidebar-link">电商通用功能-下</a></li><li><a href="/2019-09-03-share-e-commerce-marketing/" class="sidebar-link">电商业务营销功能</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>官方案例</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-tree-hole/" class="sidebar-link">树洞小程序</a></li><li><a href="/2019-09-03-share-forum/" class="sidebar-link">论坛小程序</a></li><li><a href="/2019-09-03-share-album/" class="sidebar-link">相册小程序</a></li><li><a href="/2019-09-03-share-ai-card/" class="sidebar-link">AI名片小程序</a></li><li><a href="/2019-09-03-share-beauty-album/" class="sidebar-link">智能美颜相册小程序</a></li><li><a href="/2019-09-03-share-gomoku/" class="sidebar-link">在线对战五子棋小游戏</a></li><li><a href="/2019-09-03-share-food-map/" class="sidebar-link">美食地图小程序</a></li><li><a href="/2019-09-18-share-SCRM/" class="sidebar-link">SCRM小程序</a></li><li><a href="/2019-09-26-share-avatar/" class="sidebar-link">头像小程序</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>项目实战</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-maoyan/" class="sidebar-link">猫眼</a></li><li><a href="/2019-09-03-share-zhuanzhuan/" class="sidebar-link">转转</a></li><li><a href="/2019-09-03-share-lexiang-garden/" class="sidebar-link">乐享花园</a></li><li><a href="/2019-09-03-share-cat-room/" class="sidebar-link">猫咪公寓</a></li><li><a href="/2019-09-03-share-tg-idea/" class="sidebar-link">TGidea</a></li><li><a href="/2019-09-03-share-taro-shop/" class="sidebar-link">Taro商城</a></li><li><a href="/2019-09-03-share-more-articles/" class="sidebar-link">更多教程文章</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>WEB入门教程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2020-02-14-init/" class="sidebar-link">入门须知</a></li><li><a href="/2020-02-14-prepare/" class="sidebar-link">开发准备</a></li><li><a href="/2020-02-14-WebDemo-files/" class="sidebar-link">FILE-S文件转储服务</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="个人介绍"><a href="#个人介绍" class="header-anchor">#</a> 个人介绍</h2> <p>大家好，我是Zero，一名大四的前端开发爱好者，目前主要研究微信小程序和iOS开发。</p> <p>这是第二次参加微信小程序应用开发赛，2018年我们设计了一款通过二维码寻找丢失物品的小程序《蝴蝶寻物》，获得了华北赛区三等奖。</p> <p>今年，在小程序云开发功能的大力推广下，我决定采用云开发的方式，实现一个双人互动打卡互动的小程序《Mango Daily》(中文名称《芒果日常》)。(由于是个人开发者账号，所以暂时还未上架)</p> <p><img src="https://puui.qpic.cn/vupload/0/1571716474523_eeprqrds86a.jpg/0" alt=""></p> <p>得力于云开发提供的API，本项目在较短的时间内就实现了比较理想的效果。</p> <p>接下来，我想从本项目入手，讲讲我是如何依靠<strong>小程序+云开发平台</strong>将想法快速实现的。</p> <h2 id="_1-技术准备"><a href="#_1-技术准备" class="header-anchor">#</a> 1. 技术准备</h2> <p>在去年的项目中，我们采用ThinkPHP开发了一套API系统，其中需要实现小程序的授权登录，设置鉴权来保证数据安全等操作。整个过程只有我一名开发人员，所以大致就是“先搞定后端，其次搞定界面，最后进行联调”的一个过程。</p> <p>后来在云+社区看到一篇文章：<a href="https://cloud.tencent.com/developer/article/1371289" target="_blank" rel="noopener noreferrer">《1个开发如何撑起一个过亿用户的小程序》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，觉得可以尝试一下新的开发方式。通读小程序云开发文档之后，发现并不需要学习新的技术就可以快速上手。</p> <h2 id="_2-开发"><a href="#_2-开发" class="header-anchor">#</a> 2. 开发</h2> <p>Mango Daily 使用的是小程序原生开发+云开发结合的方式进行开发的。</p> <h3 id="_2-1-界面开发"><a href="#_2-1-界面开发" class="header-anchor">#</a> 2.1 界面开发</h3> <p>界面没有使用第三方UI框架，而是自己将常用的模块封装成了组件。</p> <p><img src="https://puui.qpic.cn/vupload/0/1571716540865_jmvedccuec.jpg/0" alt=""></p> <p>图中比较核心的模块包括 TabBar、Toast、Modal、Nav等。</p> <p><img src="https://puui.qpic.cn/vupload/0/1571716570974_j2dqzxjisci.jpg/0" alt=""></p> <h3 id="_2-2-云开发"><a href="#_2-2-云开发" class="header-anchor">#</a> 2.2 云开发</h3> <p>云开发包括云数据库，云函数和云存储。本项目中三个功能均使用到。</p> <h4 id="_2-2-1-云数据库"><a href="#_2-2-1-云数据库" class="header-anchor">#</a> 2.2.1 云数据库</h4> <p><strong>云数据库</strong>是一个非关系型数据库，在实际开发中基本符合本项目的需求。部分表关联查询则是通过分步查询的方式代替。</p> <p>云数据库已经实现了自动鉴权，可以保证数据的安全性。目前云数据库只支持以下几种权限：</p> <ul><li>所有用户可读，仅创建者可读写</li> <li>仅创建者可读写</li> <li>所有用户可读</li> <li>所有用户不可读写</li></ul> <p>默认情况下是***仅创建者可读写***，所以在首次开发时，手动插入的测试数据并不一定可以在前端顺利读取，需要修改集合的权限。</p> <p>云数据库的调用在前端代码中即可完成。但是从上面几种读写权限来看，并没有办法实现对另一个用户创建的数据进行修改或者删除的操作(当然这也是非常不可取的)，于是云函数就派上用场了。</p> <h4 id="_2-2-2-云函数"><a href="#_2-2-2-云函数" class="header-anchor">#</a> 2.2.2 云函数</h4> <p>我理解的云函数，则是跑在云端的一个函数脚本文件。</p> <p>在接触云开发之前，如果我们想要去调用微信公众平台提供的API(例如发起退款、发送模板消息等)，则需要在后端代码去实现，然后只需要给前端返回一个JSON表示请求状态即可。或者想要去实现上述描述中，修改一条由他人创建的数据的功能时，都是有后端工程师去完成的。</p> <p>在本次开发中，我深刻体会到了云函数的强大，以及微信公众平台工程师设计产品的严谨性。</p> <p>Mango Daily用到了微信公众平台的模板消息功能，所以需要在合适的时机请求微信官方提供的API。</p> <p>因为取消了后端的开发，所以一开始打算直接在小程序端去请求官方API。但是失败了。因为此请求涉及APPKEY等重要信息，禁止在小程序端代码中直接请求官方API。这样就可以通过云函数去代替先前的后端开发，最后将状态返回给小程序端即可。</p> <p>例如想给新用户发送一条短信，以往的做法是客户端请求后端API，然后由后端完成发送短信操作。这里云函数就代替了后端开发。如果仅仅依靠小程序JS代码去发送短信，是非常不可取的。</p> <p>另外，云函数对云数据库有更高的操作权限，所以想要修改、删除他人生成的数据时，云函数可以直接进行操作。</p> <p>云函数还提供定时触发功能，不过在本项目中暂未涉及。</p> <h4 id="_2-2-3-云存储"><a href="#_2-2-3-云存储" class="header-anchor">#</a> 2.2.3 云存储</h4> <p>本次开发省去了使用其他服务商的存储服务，全部得力于云存储功能。云存储允许上传多种文件类型，像图片、音频等文件还可以直接在小程序端调用。这里我们使用云存储实现了文章插图的功能。</p> <p><img src="https://puui.qpic.cn/vupload/0/1571716591013_7idf0mln7ei.jpg/0" alt=""></p> <h3 id="_2-3-优化"><a href="#_2-3-优化" class="header-anchor">#</a> 2.3 优化</h3> <h3 id="_2-3-1-数据层封装"><a href="#_2-3-1-数据层封装" class="header-anchor">#</a> 2.3.1 数据层封装</h3> <p>Mango Daily 数据操作进行了两次封装，一层是对云数据库API进行封装，第二层是每一个数据集合都对应一个Manager管理层。</p> <p>以用户集合 <strong>User，Article</strong> 为例，项目中的结构如下：</p> <p>util
|- db.js</p> <p>manager
|- Article.js
|- User.js</p> <p>db.js 是对云数据库API的封装，实现了增删查改等操作，以更新数据为例。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 更新数据
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">collection<span class="token punctuation">,</span> _id<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">exist</span><span class="token punctuation">(</span>collection<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">reject</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">,</span> resCode<span class="token punctuation">[</span><span class="token number">401</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span>collection<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span>_id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            data<span class="token operator">:</span> data
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Article.js</strong> 是文章集合的管理类，同样实现了增删查改等操作，不过其是基于 <strong>db.js</strong> 进行扩展的。以更新文章操作为例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 更新
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">_id<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        db<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>collection<span class="token punctuation">,</span> _id<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>之所以封装两层，是想尽量减少Page对象中对云数据库的直接调用。这样在页面js文件中只需要调用某一个Manager提供的函数即可。</p> <h3 id="_2-3-3-后台上传策略"><a href="#_2-3-3-后台上传策略" class="header-anchor">#</a> 2.3.3 后台上传策略</h3> <p>Mango Daily还实现了发送模板消息的功能，这就涉及到了FromID的收集。目前FromID的收集大部分采用埋点的方式。
如果每次采集到新的FromID都直接上传到数据库存储，可能会造成网络资源的浪费，所以需要选择合适的时机上传数据。</p> <p>在本项目中，每次采集到FromID，首先存到 <strong>globalData</strong> 中，当小程序进入后台状态时，再进行数据的上传。</p> <p><strong>app.js</strong> 中的实现：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
* 后台监听
*/</span>
<span class="token function-variable function">onHide</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">uploadFormID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">/**
* 上传token
*/</span>
<span class="token function-variable function">uploadFormID</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ids <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>formIds<span class="token punctuation">;</span>
        
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ids<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">let</span> formId <span class="token operator">=</span> ids<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">this</span><span class="token punctuation">.</span>push<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span>formId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;上传formID:&quot;</span> <span class="token punctuation">,</span> formId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">uploadFormID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="_3-维护"><a href="#_3-维护" class="header-anchor">#</a> 3. 维护</h2> <p>很遗憾，这一部分可能没有太多需要写的。
在18年的项目中，需要考虑数据库的维护问题。但是使用了云开发之后，Serverless的优点就表现出来了。我无须将太多的精力放在后端的维护上。</p> <h2 id="_4-总结"><a href="#_4-总结" class="header-anchor">#</a> 4. 总结</h2> <p>在本次项目开发中，我深刻体会到了云开发的便捷性。无须自己实现鉴权，对接第三方存储。数据方面，增删查改功能非常方便。云开发提供的种种便利，让我在有新创意的时候，优先选择小程序+云开发的方式去实现。</p> <div class="language- extra-class"><pre class="language-text"><code>你好，你的小程序涉及用户自行生成内容的发布/分享/交流，属社交范畴，为个人主体小程序未开放类目，建议申请企业主体小程序
</code></pre></div><p>另外，Mango Daily中的随笔功能属于用户自行生成内容功能，所以在上架的时候，个人开发者账号是不被允许的，所以在考虑上架产品的时候，请按照实际情况酌情考虑选择账号主体类型。</p> <h2 id="源码地址"><a href="#源码地址" class="header-anchor">#</a> 源码地址</h2> <p><a href="https://github.com/ixzk/WeDaily-Weapp" target="_blank" rel="noopener noreferrer">https://github.com/ixzk/WeDaily-Weapp<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/TencentCloudBase/blog/edit/master/docs/案例教学/2.项目实战/更多教程文章/小程序云开发实战-互动打卡.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">更新于:</span> <span class="time">2020-01-16 13:47:57</span></div></footer> <!----> </main></div><div class="global-ui"><div></div><!----><!----><div></div></div></div>
    <script src="/assets/js/app.d354b57d.js" defer></script><script src="/assets/js/2.633ad409.js" defer></script><script src="/assets/js/3.c53e7137.js" defer></script><script src="/assets/js/188.2accadf2.js" defer></script><script src="/assets/js/5.fbbd7676.js" defer></script>
  </body>
</html>
